+++
title = "テキストオブジェクトが何行目か取得する"
date = "2010-11-17T00:00:00+09:00"
tags = ["indesign", "extendscript"]
+++
選択したテキストオブジェクトや検索結果のテキストオブジェクトが何ページにある？はよく使うのですが、そのページの何行目？

ってどうやるんだろうってことでテストしてみました。

レポートをリスト出力するときとかみんなどうやってるんだろう？

色々考えてみて、

対象テキストの最初 LineObject の index と、その親 TextObject がもっている LinesObject(s) のそれぞれの index を比較していって、**マッチしたところが何行目**じゃないかと。（もっと簡単な方法ありますか？）

親を取得するのに parent を使うと連結テキストフレームの最初から数えた行数をだすので、代わりに parentTextFrames[0] を使うとテキストフレームごとになるとか、表組では親が CellObject になるので parent を使うとか、そんなこんなで割とすぐ出来たのでメモ。

全然関係ないけど、表組のセル内では「サンプルテキストの割り付け」ってできないんだねー

![/images/2010/11/get_line.png](/images/2010/11/get_line.png)

あと、何行目？って意味だったら複数形化は不要だったかも。jsには railsのpluralizeメソッドみたいなのないのかな？

<script src="https://gist.github.com/milligramme/1dea59686f5b333ca9a9.js"></script>